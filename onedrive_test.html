<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>onedrive</title>
</head>
<body>
    <input id="fileUploadControl" name="fileUploadControl" type="file" />
    <button onclick="launchSaveToOneDrive">Save to OneDrive</button>
    <p id="status"></p>

    <script type="text/javascript" src="https://js.live.net/v7.2/OneDrive.js"></script>
    <script type="text/javascript">
        function launchSaveToOneDrive(){
            var odOptions = {
                clientId: "a2de90c3-14db-4b3b-8812-3754b67378d3",
                action: "save",
                sourceInputElementId: "fileUploadControl",
                sourceUri: "",
                openInNewWindow: false,
                advanced: {},
                success: function(files) {
                    document.getElementById("status").innerHTML = "Файлы отправлены: " + files;
                },
                progress: function(percent) {
                    document.getElementById("status").innerHTML = "Загрузка: " + percent + "%";
                },
                cancel: function() {
                    document.getElementById("status").innerHTML = "Отменено";
                },
                error: function(error) {
                    document.getElementById("status").innerHTML = "Ошибка: " + error;
                }
            };
            OneDrive.save(odOptions);
        }
      </script>
</body>
</html>
